services:
  claude:
    build:
      context: .
    volumes:
      # Mount current working directory as /workspace
      - ${HOST_CWD:-.}:/workspace
      # Mount repos
      - ${HOME}/code/cyborg:/home/node/code/cyborg
      - ${HOME}/code/ziliang:/home/node/code/ziliang
      - ${HOME}/code/world:/home/node/code/world
      - ${HOME}/dotfiles:/home/node/code/dotfiles
      # Mount container home directory (for .config, etc)
      - ${HOME}/.claude/sandboxed-home:/home/node
      # Mount Claude config (selective - only what sandbox needs)
      - ${HOME}/.claude/CLAUDE.md:/home/node/.claude/CLAUDE.md:rw
      - ${HOME}/.claude/memory:/home/node/.claude/memory:rw
      - ${HOME}/.claude/skills:/home/node/.claude/skills:rw
      # Mount git config for commits
      - ${HOME}/.gitconfig:/home/node/.gitconfig:ro
      # Note: SSH keys are in ${HOME}/.claude/sandboxed-home/.ssh (dedicated sandbox key)
    stdin_open: true
    tty: true
